**AXI Protocol TL;DR**
---

```markdown
# 🧠 AXI Protocol – TL;DR Summary

## 🔹 Structure
- Point-to-point specification  
- **5 independent unidirectional channels:**
  - `AW` – Address Write →
  - `W` – Write Data →
  - `B` – Write Response ←
  - `AR` – Address Read →
  - `R` – Read Data ←
- Each channel uses `VALID` / `READY` handshake  

---

## ⚙️ Key Features
- Separate **Read** and **Write** paths → Full duplex, higher bandwidth  
- **Multiple outstanding transactions** via IDs (parallel threads)  
- No timing relation between address and data  
- **Burst transfers:** single address, slave auto-calculates next  
- **Unaligned transfers** (no data loss)  
- **Out-of-order completion** across IDs allowed  

---

## 🔁 Handshake Basics
- `VALID` → from source, must stay high until accepted  
- `READY` → from destination, can assert anytime  
- One `VALID`–`READY` handshake = **one transfer**

---

## 🧮 Transfer vs Transaction
- **Transfer:** One beat (single handshake)  
- **Transaction:** Complete read or write burst  

---

## ✍️ Write Transaction
- `WLAST` = last data beat  
- Slave can detect end using `SIZE` and `LENGTH`  
- One `BRESP` for entire burst  
- Errors reported only after burst completion  

---

## 📖 Read Transaction
- `RRESP` for each beat (no separate response channel)  
- Burst must complete (no early termination)  

---

## 🧾 Active / Outstanding Transactions
- **Read:** `AR` sent but last `RDATA` not yet received  
- **Write:** `AW` sent but `BRESP` not yet received  
- **Note:**  
  - Read address must come before data  
  - Write data may lead or follow address  

---

## 🔄 AXI3 vs AXI4

| Feature | AXI3 | AXI4 |
|----------|------|------|
| Burst length | `AxLEN[3:0]` (16 beats) | `AxLEN[7:0]` (256 beats) |
| Lock type | `AxLOCK[1:0]` | Single-bit exclusive access |
| Write ID | `WID` present (data interleaving allowed) | `WID` removed (no interleaving) |
| Extra signals | — | `AWQOS`, `AWREGION`, `AWUSER`, `WUSER`, `BUSER` |

---

## 🛡️ Protection Bits – `AxPROT[2:0]`
| Bit | Meaning |
|-----|----------|
| 0 | Instruction/Data (0 = data) |
| 1 | Secure/Non-secure |
| 2 | Privilege/User |

---

## 💾 Cache Control
- **Read Allocate:** Cache read miss → allocate line  
- **Write Allocate:** Cache write miss → allocate line  
- If disabled → always access main memory  

---

## 🧱 Response Codes
| Code | Meaning |
|------|----------|
| 00 | OKAY / Exclusive fail |
| 01 | EXOKAY |
| 10 | SLVERR (invalid access, size mismatch, read-only write) |
| 11 | DECERR (invalid address) |

---

## 🔒 Atomic Access (AxLOCK)
### Locked Access
- Channel locked until unlocked by same master  
### Exclusive Access
- Ensures read-modify-write safety between masters  
- Example:  
  - M1 ex-read @0x04 → M1 ex-write → **EXOKAY** (success)  
  - If M2 writes between → M1 ex-write → **OKAY** (fail)

---

## 🚦 QoS – `AxQOS`
- Priority hint for masters  
- `0x0` = lowest, `0xF` = highest  

---

## 📤 Channel Dependencies
- `WLAST` must complete before `BVALID`  
- AXI3: response can appear before address  
- AXI4: all address/data must complete before response  
- `RVALID` only after `ARADDR` transfer  
- `WVALID` can assert before `AWVALID`

---

## 🧩 Ordering & IDs
- All transfers in a txn → **same ID**  
- Master can issue **multiple IDs** → multiple threads  

### Write Ordering (No Interleaving in AXI4)
- Data must follow address order:  
  `A0A1AL → B0B1BL` ✅  
  `A0B0B1A1ALBL` ❌  
- Responses can complete **out-of-order** across IDs  
```

(A0A1AL, ID0) (B0B1BL, ID1)
BRESP: B(ID1) → A(ID0)

```
- Same ID → must complete in order  

### Read Ordering (Interleaving Allowed)
- RDATA of different IDs can be interleaved freely  
```

(B0,ID1) (A0,ID0) (B1,ID1) (A1,ID0)

```
- Same ID → data must be in order  

---

## 📍 Unaligned Transfers
- Only first transfer affected by alignment  
- Example:  
```

AWADDR = 1, AWSIZE = 2, AWLEN = 5
Total = 4B * 5 = 20B → first byte masked by WSTRB

```

---

## 📦 4KB Boundary Rule
Each slave gets 4KB address space.  
Transaction must not cross 4KB boundary.

**Constraint:**  
```

(AWADDR % 4096) + (2^AWSIZE * (AWLEN + 1)) ≤ 4096

```

---

## 📏 Address Calculations
**End Address:**  
```

AWADDR + 2^AWSIZE * (AWLEN - 1)

```

**Wrap Boundary:**  
```

int(start_addr / total_transfer) * total_transfer

```

**Wrap Example:**  
```

AWADDR = 4, AWSIZE = 2, AWLEN = 3
→ wrap boundary = 0, end = 16

```

---

## 🔢 Strobe (WSTRB)
- Bits = data_width / 8  
- `#ones = 2^AWSIZE`  
- Examples:  
  - size=0 → 1 byte  
  - size=1 → 2 bytes  
  - size=2 → 4 bytes  

---

## 🧠 Concept Links
- **Interleaving** → W/R channel data ordering  
- **Out-of-order** → B/R response completion  

---
```

---
